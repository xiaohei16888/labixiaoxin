  </div>

  <script>
    const users = [
      { username: 'test1', password: '123456' },
      { username: 'test2', password: '123456' },
      { username: 'test3', password: '123456' },
      { username: 'test4', password: '123456' },
      { username: 'test5', password: '123456' },
    ];

    function login() {
      const user = document.getElementById('username').value;
      const pass = document.getElementById('password').value;
      const valid = users.some(u => u.username === user && u.password === pass);
      if (valid) {
        localStorage.setItem('login', 'yes');
        document.getElementById('loginPage').classList.add('hidden');
        document.getElementById('mainApp').classList.remove('hidden');
        document.getElementById('loginError').classList.add('hidden');
      } else {
        document.getElementById('loginError').classList.remove('hidden');
      }
    }

    function logout() {
      localStorage.removeItem('login');
      location.reload();
    }

    window.onload = () => {
      if (localStorage.getItem('login') === 'yes') {
        document.getElementById('loginPage').classList.add('hidden');
        document.getElementById('mainApp').classList.remove('hidden');
      }
    };

    // 上传 + 导出功能
    let uploadedData = [];
    document.getElementById('fileInput').addEventListener('change', function(e) {
      const file = e.target.files[0];
      const reader = new FileReader();
      reader.onload = function(e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: 'array' });
        const sheet = workbook.Sheets[workbook.SheetNames[0]];
        const json = XLSX.utils.sheet_to_json(sheet, { header: 1 });

        if (json.length === 0) return;

        const newHeader = [...json[0], "模拟余额"];
        uploadedData = [newHeader];
        const bodyRows = json.slice(1).map(row => {
          const balance = `$${Math.floor(Math.random() * 490) + 10}`;
          uploadedData.push([...row, balance]);
          return [...row, balance];
        });

        const header = document.getElementById("tableHeader");
        header.innerHTML = "";
        newHeader.forEach(col => {
          const th = document.createElement("th");
          th.className = "border px-4 py-2";
          th.innerText = col;
          header.appendChild(th);
        });

        const body = document.getElementById("tableBody");
        body.innerHTML = "";
        bodyRows.forEach(row => {
          const tr = document.createElement("tr");
          row.forEach(cell => {
            const td = document.createElement("td");
            td.className = "border px-4 py-2";
            td.innerText = cell ?? "";
            tr.appendChild(td);
          });
          body.appendChild(tr);
        });

        document.getElementById("output").classList.remove("hidden");
      };
      reader.readAsArrayBuffer(file);
    });

    document.getElementById('exportBtn').addEventListener('click', function () {
      const ws = XLSX.utils.aoa_to_sheet(uploadedData);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "导出结果");
      XLSX.writeFile(wb, "蜡笔小新导出结果.xlsx");
    });

    function checkNike() {
      const card = document.getElementById("nikeCard").value.trim();
      const pin = document.getElementById("nikePin").value.trim();
      if (!card || !pin) {
        document.getElementById("nikeResult").innerText = "请输入卡号和PIN";
        return;
      }
      const fakeBalance = `$${Math.floor(Math.random() * 400 + 50)}`;
      document.getElementById("nikeResult").innerText = `查询成功，余额：${fakeBalance}`;
    }

    function checkTarget() {
      const card = document.getElementById("targetCard").value.trim();
      const pin = document.getElementById("targetPin").value.trim();
      if (!card || !pin) {
        document.getElementById("targetResult").innerText = "请输入卡号和PIN";
        return;
      }
      const fakeBalance = `$${Math.floor(Math.random() * 300 + 20)}`;
      document.getElementById("targetResult").innerText = `查询成功，余额：${fakeBalance}`;
    }
  </script>
</body>
</html>
  </div>

  <script>
    const users = [
      { username: 'test1', password: '123456' },
      { username: 'test2', password: '123456' },
      { username: 'test3', password: '123456' },
      { username: 'test4', password: '123456' },
      { username: 'test5', password: '123456' },
    ];

    function login() {
      const user = document.getElementById('username').value;
      const pass = document.getElementById('password').value;
      const valid = users.some(u => u.username === user && u.password === pass);
      if (valid) {
        localStorage.setItem('login', 'yes');
        document.getElementById('loginPage').classList.add('hidden');
        document.getElementById('mainApp').classList.remove('hidden');
        document.getElementById('loginError').classList.add('hidden');
      } else {
        document.getElementById('loginError').classList.remove('hidden');
      }
    }

    function logout() {
      localStorage.removeItem('login');
      location.reload();
    }

    window.onload = () => {
      if (localStorage.getItem('login') === 'yes') {
        document.getElementById('loginPage').classList.add('hidden');
        document.getElementById('mainApp').classList.remove('hidden');
      }
    };

    // 上传 + 导出功能
    let uploadedData = [];
    document.getElementById('fileInput').addEventListener('change', function(e) {
      const file = e.target.files[0];
      const reader = new FileReader();
      reader.onload = function(e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: 'array' });
        const sheet = workbook.Sheets[workbook.SheetNames[0]];
        const json = XLSX.utils.sheet_to_json(sheet, { header: 1 });

        if (json.length === 0) return;

        const newHeader = [...json[0], "模拟余额"];
        uploadedData = [newHeader];
        const bodyRows = json.slice(1).map(row => {
          const balance = `$${Math.floor(Math.random() * 490) + 10}`;
          uploadedData.push([...row, balance]);
          return [...row, balance];
        });

        const header = document.getElementById("tableHeader");
        header.innerHTML = "";
        newHeader.forEach(col => {
          const th = document.createElement("th");
          th.className = "border px-4 py-2";
          th.innerText = col;
          header.appendChild(th);
        });

        const body = document.getElementById("tableBody");
        body.innerHTML = "";
        bodyRows.forEach(row => {
          const tr = document.createElement("tr");
          row.forEach(cell => {
            const td = document.createElement("td");
            td.className = "border px-4 py-2";
            td.innerText = cell ?? "";
            tr.appendChild(td);
          });
          body.appendChild(tr);
        });

        document.getElementById("output").classList.remove("hidden");
      };
      reader.readAsArrayBuffer(file);
    });

    document.getElementById('exportBtn').addEventListener('click', function () {
      const ws = XLSX.utils.aoa_to_sheet(uploadedData);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "导出结果");
      XLSX.writeFile(wb, "蜡笔小新导出结果.xlsx");
    });

    function checkNike() {
      const card = document.getElementById("nikeCard").value.trim();
      const pin = document.getElementById("nikePin").value.trim();
      if (!card || !pin) {
        document.getElementById("nikeResult").innerText = "请输入卡号和PIN";
        return;
      }
      const fakeBalance = `$${Math.floor(Math.random() * 400 + 50)}`;
      document.getElementById("nikeResult").innerText = `查询成功，余额：${fakeBalance}`;
    }

    function checkTarget() {
      const card = document.getElementById("targetCard").value.trim();
      const pin = document.getElementById("targetPin").value.trim();
      if (!card || !pin) {
        document.getElementById("targetResult").innerText = "请输入卡号和PIN";
        return;
      }
      const fakeBalance = `$${Math.floor(Math.random() * 300 + 20)}`;
      document.getElementById("targetResult").innerText = `查询成功，余额：${fakeBalance}`;
    }
  </script>
</body>
</html>


